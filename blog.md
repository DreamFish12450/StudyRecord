# 8.6会议及思考

## 关于并行

时间换空间，不知道流元组的大小。提出时间换空间的策略。
</br>

### `桶排序`。对于预分配的空间有问题

计数排序显然不可。及关键还是在于值域的划分和一个映射函数的关系如果用桶排序是不是最后的归并的时间也可以相对的减少
我觉得这个很可。
>快速排序是将集合拆分为两个值域，这里称为两个桶，再分别对两个桶进行排序，最终完成排序。桶排序则是将集合拆分为多个桶，对每个桶进行排序，则完成排序过程。两者不同之处在于，快排是在集合本身上进行排序，属于原地排序方式，且对每个桶的排序方式也是快排。桶排序则是提供了额外的操作空间，在额外空间上对桶进行排序，避免了构成桶过程的元素比较和交换操作，同时可以自主选择恰当的排序算法对桶进行排序。

>当然桶排序更是对计数排序的改进，计数排序申请的额外空间跨度从最小元素值到最大元素值，若待排序集合中元素不是依次递增的，则必然有空间浪费情况。桶排序则是弱化了这种浪费情况，将最小值到最大值之间的每一个位置申请空间，更新为最小值到最大值之间每一个固定区域申请空间，尽量减少了元素值大小不连续情况下的空间浪费情况。

### 还有就是上次讲的把索引的构建给查询节点

大致思考一下就是再接受最后一个分片之间先把整个树的大小传过去进行一个树的预购建。当分片接受完之后。进行压缩吧压缩好的数据发送过去
</br>
## 数据压缩
&emsp;&emsp;那么问题来了?压缩的`算法`。以及`并行压缩`是否可行
并行压缩个人想的是中间加一定特定的标记来告诉他这是一个压缩的分片。当最后的时候再传输过去

关于数据压缩论文给的是谷歌的`protocol-buffer`。他和xml不同的是其对于压缩区别于xml的直接使用ASCⅡ码他使用了一种叫做Varint 编码的技术。个人感觉是先将数字或者字符转成ASCⅡ然后再用这个进行一次压缩。他的优势主要是啥？它能用一个或多个字节来表示一个数字，值越小的数字使用越少的字节数。这能减少用来表示数字的字节数。。性能高。他里面用的数字编码也就是 ZigZag 编码就是对于一些小的正负数的表现效果极佳。
[参考链接1](https://developers.google.com/protocol-buffers/docs/proto3)
[参考链接2](ibm.com/developerworks/cn/linux/l-cn-gpb/index.html)

那么和这个`protocol-buffer`一起使用的就不得不提一下grpc.所谓RPC(remote procedure call 远程过程调用)前面那个g就是谷歌的意思。官网的介绍是
>A high-performance, open-source universal RPC framework

那为啥他表现好呢
`\\TODO举个例子放在PPT里`

他的一个优点是支持HTTP2.0

HTTP2.0好在哪里呢？他如何在不改进其语义、方法、状态码、URI 以及首部字段….. 的情况下对其进行改善

先再来看看HTTP1.X的缺点<br>

1. 一个TCP连接上只能发送一个HTTP请求。虽然有流水线技术可以让其变的更快，但是其队列头仍然会出现堵塞的情况

2. 其首部信息冗余较大。且报文内部未进行压缩

TCP用来建立连接而HTTP则是真正的用来传输报文的
TCP是底层通讯协议，定义的是数据传输和连接方式的规范
HTTP是应用层协议，定义的是传输数据的内容的规范
那么2.0好在哪里呢？首先其有一个叫多路复用的技术。
HTTP2.0中,有两个概念非常重要:帧(frame)和流(stream) 帧是最小的数据单位,每个帧会标识出该帧属于哪个流,流是多个帧组成的数据流 所谓多路复用,即在一个TCP连接中存在多个流,即可以同时发送多个请求,对端可以通过帧中的表示知道该帧属于哪个请求 在客户端,这些帧乱序发送,到对端后再根据每个帧首部的流标识符重新组装 通过该技术,可以避免HTTP旧版本的队头阻塞问题,极大提高传输性能。

同时其首部有着压缩算法HPACK

## 顶层索引

关于顶层索引如果采用哈希环的话是不是可以对哈希环的规模之类进行限制。或者说将哈希环和树结合在一起。


//TODO桶排序和快速排序据图时间比较





